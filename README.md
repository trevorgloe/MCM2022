# MCM2022
Code for the COMAP 2022 math contest in modeling, team control number 2226471

Team members: Trevor Loe, Madison Lytle, Callan Whitney

The competiton was completed Febuary 18-20, 2022. 

## System Specs
This code was created and run in MATLAB 2021b. It will likely work with further systems but has not been extensively tested. The optimization toolbox is required, specifically for the function ```fmincon```.

## File Description
### Simulation Scripts
- [main](main.m) This script runs the model based on the parameter values defined in [params_discrete](params_discrete.m). Saves the data to a local file in the data folder model_data/ followed by the data and time the simulation was run. This is done using the following scripts called 
  - [sqp_solve](sqp_solve.m) which makes a call to [sqp_run_new](sqp_run_new.m), the script utilizing a sequential quadratic programming method to solve the constrained optimization problem, with constraint equations given by the Skiba model. The structure ```biker``` is passed in containing all the rider parameters. The structure ```course``` is passed in, containing the necessary course parameters (the length, grade, and environmental parameters. The structure ```disc``` is passed in containing the simulation discretization information. 
  - [save_data_params](save_data_params.m) will save the data according the file structure described below.
  - [convert_v](convert_v.m) converts the velocity output by the optimization into the useful metrics of power, and total course completion time, based on the other parameters in the workspace.
- [plotting](plotting.m) often used within [main](main.m) to plot the outputs of the optimization.
- [rider_structs](rider_structs.m) creates the structures containing the rider parameters used in the model and saves them to the workspace, to be used by other scripts as the model is run.
- [sensativity_analysis](sensitivity_analysis.m) runs a model sensativity study on a chosen parameter, saves all the generated data, and compares the veleocity, power and completion time. 

Other scripts such as other versions of sqp_run are modified to include additional environmental parameters.

### Data Scripts
- [get_courses](get_courses.m) extracts the useful course parameters (course grade, lat, lon, etc.) from the csv files containing the course information from online.
- [DistanceCalcs](DistanceCalcs.m) Uses the latitude and longitude obtained from reading the data in one of the course csv files to generate the course grade, phi and course curvature from the data.

## Model Data File Structure
The data saved from the model is stored in the following structure 
- A directory inside model_data/ named by the data and time in mn-day-yr_hr-min-sc format. 
  - Within this directory there are 3 files: one ending in ```_P_.mat``` which contains the optimized rider power output as a matrix, one ending in ```_v_.mat``` which contains the optimized rider velocity as a matrix, and one ending in ```_params_``` which contains the structure containing all the rider parameters.

Data used to generate courses is stored within the data/ directory

Figures generated by the model output, used in the paper are stored in figures/

## Other Comments
Depriciated files that are no longer used are stored within the ancient/ directory.
